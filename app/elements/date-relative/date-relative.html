<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../lib-momentjs/lib-momentjs.html">
<link rel="import" href="../date-tick/date-tick.html">

<dom-module id="date-relative">
  <template>
    <style>
      :host {
        display: inline-block;
      }
    </style>

    <date-tick on-tick="_updateLastUpdateFromTickEvent"></date-tick>
    [[dateString]]
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'date-relative',
        
        properties: {
          date: {
            type: Number
          },
          dateString: {
            type: String,
            computed: 'formatDate(date, lastUpdate)'
          },
          lastUpdate: {
            type: Number,
            readOnly: true,
            reflectToAttribute: true
          }
        },
        
        formatDate: function(date) {
          return moment(date).fromNow();
        },
        
        _updateLastUpdateFromTickEvent: function(tickEvent) {
          var component = this;
          component._setLastUpdate(tickEvent.detail);
        }
      });
    })();
  </script>
</dom-module>
