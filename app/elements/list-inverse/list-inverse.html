<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="list-inverse">
  <template>
    <style>
      :host {
        display: none;
      }
    </style>
  </template>

  <script>
    (function() {
      'use strict';
      
      function invertList(list) {
          var inverseList = [];
          
          for (var i = 0; i < list.length; i++) {
            inverseList.push(list[list.length - i - 1]);
          }
          
          return inverseList;
        }

      Polymer({
        is: 'list-inverse',
        
        properties: {
          list: {
            type: Array,
            value: function() {
              return [];
            }
          },
          inverseList: {
            type: Array,
            readOnly: true,
            notify: true
          }
        },
        
        observers: ['_initInverseList(list)', '_updateInverseList(list.splices)', /* '_updateList(inverseList.splices)'*/],
        
        _initInverseList: function(list) {
          var component = this;
          
          component._setInverseList(invertList(list));
        },
        
        _updateInverseList: function(listSplices) {
          var component = this;
          if (listSplices) {
            listSplices.indexSplices.forEach(function(splice) {
              if (splice.removed.length > 0) {
                component.splice('inverseList', splice.object.length + splice.removed.length - splice.addedCount - splice.index - 1, splice.removed.length);
              }
              
              if (splice.addedCount > 0) {
                var inverseSlice = splice.object.slice(splice.index, splice.index + splice.addedCount);
                component.splice.apply(component, ['inverseList', splice.object.length + splice.removed.length - splice.addedCount - splice.index, 0].concat(inverseSlice));  
              }
            })
          }
        }
      });
    })();
  </script>
</dom-module>
